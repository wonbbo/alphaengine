# AlphaEngine v2 이벤트 타입 레퍼런스

이 문서는 AlphaEngine v2에서 사용하는 모든 이벤트 타입의 목록과 한글 명칭, 발생 원인을 정리합니다.

---

## 목차

1. [엔진 / 제어](#엔진--제어)
2. [웹소켓 연결](#웹소켓-연결)
3. [주문 / 체결](#주문--체결)
4. [포지션 / 잔고 / 수수료](#포지션--잔고--수수료)
5. [내부 이체](#내부-이체)
6. [입금 (Upbit KRW → Binance Futures USDT)](#입금-upbit-krw--binance-futures-usdt)
7. [출금 (Binance Futures USDT → Upbit KRW)](#출금-binance-futures-usdt--upbit-krw)
8. [정합성 / 감사](#정합성--감사)
9. [전략](#전략)
10. [BNB 수수료 관리](#bnb-수수료-관리)

---

## 엔진 / 제어

| 이벤트명 | 한글명 | 발생 원인 |
|---------|--------|----------|
| `EngineStarted` | 엔진 시작 | Bot 프로세스가 시작되어 엔진이 초기화됨 |
| `EngineStopped` | 엔진 중지 | Bot 프로세스가 정상 종료됨 |
| `EnginePaused` | 엔진 일시정지 | 수동 명령 또는 리스크 가드에 의해 거래 일시 중지 |
| `EngineResumed` | 엔진 재개 | 일시정지 상태에서 거래 재개 |
| `EngineModeChanged` | 엔진 모드 변경 | 엔진 모드 변경 (예: LIVE → PAPER, PAPER → LIVE) |
| `ManualOverrideExecuted` | 수동 오버라이드 | 관리자가 Web UI에서 수동 명령 실행 |
| `RiskGuardRejected` | 리스크 가드 거부 | 리스크 관리 규칙에 의해 주문/행위 거부됨 |
| `ConfigChanged` | 설정 변경 | 런타임 설정값 변경 (심볼, 레버리지, 전략 파라미터 등) |

---

## 웹소켓 연결

| 이벤트명 | 한글명 | 발생 원인 |
|---------|--------|----------|
| `WebSocketConnected` | 웹소켓 연결 | Binance WebSocket 연결 성공 |
| `WebSocketDisconnected` | 웹소켓 끊김 | Binance WebSocket 연결 끊김 (네트워크 오류 등) |
| `WebSocketReconnected` | 웹소켓 재연결 | 끊긴 WebSocket 연결이 재연결됨 |

---

## 주문 / 체결

| 이벤트명 | 한글명 | 발생 원인 |
|---------|--------|----------|
| `OrderPlaced` | 주문 생성 | 거래소에 주문이 성공적으로 접수됨 |
| `OrderRejected` | 주문 거부 | 거래소에서 주문 거부 (잔고 부족, 잘못된 파라미터 등) |
| `OrderCancelled` | 주문 취소 | 주문이 취소됨 (수동 취소 또는 시스템 취소) |
| `OrderUpdated` | 주문 업데이트 | 주문 상태 변경 (부분 체결 등) |
| `TradeExecuted` | 체결 | 주문의 전체 또는 일부가 체결됨 |

---

## 포지션 / 잔고 / 수수료

| 이벤트명 | 한글명 | 발생 원인 |
|---------|--------|----------|
| `PositionChanged` | 포지션 변경 | 포지션 수량, 진입가, 마크가격 등 변경 |
| `BalanceChanged` | 잔고 변경 | 계정 잔고 변경 (체결, 입출금, 수수료 등) |
| `FeeCharged` | 수수료 부과 | 거래 수수료가 차감됨 |
| `FundingApplied` | 펀딩비 적용 | 선물 펀딩 수수료 정산 (지급 또는 수령) |

---

## 내부 이체

| 이벤트명 | 한글명 | 발생 원인 |
|---------|--------|----------|
| `InternalTransferRequested` | 내부이체 요청 | Spot ↔ Futures 간 내부 이체 요청 |
| `InternalTransferCompleted` | 내부이체 완료 | 내부 이체 성공 |
| `InternalTransferFailed` | 내부이체 실패 | 내부 이체 실패 (잔고 부족 등) |

---

## 입금 (Upbit KRW → Binance Futures USDT)

입금 플로우: **Upbit KRW → TRX 매수 → Binance Spot 전송 → USDT 환전 → Futures 이체**

| 이벤트명 | 한글명 | 발생 원인 |
|---------|--------|----------|
| `DepositDetected` | 입금 감지 | 외부에서 입금 감지됨 (범용) |
| `DepositInitiated` | 입금 시작 | 입금 프로세스 시작 |
| `DepositTrxPurchased` | TRX 매수 (입금) | Upbit에서 KRW로 TRX 매수 완료 |
| `DepositTrxSent` | TRX 전송 (입금) | Upbit → Binance Spot으로 TRX 전송 |
| `DepositTrxReceived` | TRX 수신 (입금) | Binance Spot에 TRX 입금 확인 |
| `DepositUsdtConverted` | USDT 환전 (입금) | Binance Spot에서 TRX → USDT 환전 |
| `DepositSpotTransferred` | 현물→선물 이체 | Binance Spot → Futures로 USDT 이체 |
| `DepositCompleted` | 입금 완료 | 전체 입금 프로세스 완료 |

---

## 출금 (Binance Futures USDT → Upbit KRW)

출금 플로우: **Futures → Spot 이체 → TRX 환전 → Upbit 전송 → KRW 환전**

| 이벤트명 | 한글명 | 발생 원인 |
|---------|--------|----------|
| `WithdrawRequested` | 출금 요청 | 외부 출금 요청됨 (범용) |
| `WithdrawFailed` | 출금 실패 | 출금 실패 (범용) |
| `WithdrawInitiated` | 출금 시작 | 출금 프로세스 시작 |
| `WithdrawFuturesTransferred` | 선물→현물 이체 | Binance Futures → Spot으로 USDT 이체 |
| `WithdrawUsdtConverted` | TRX 환전 (출금) | Binance Spot에서 USDT → TRX 환전 |
| `WithdrawTrxSent` | TRX 전송 (출금) | Binance → Upbit으로 TRX 전송 |
| `WithdrawTrxReceived` | TRX 수신 (출금) | Upbit에 TRX 입금 확인 |
| `WithdrawKrwConverted` | KRW 환전 (출금) | Upbit에서 TRX → KRW 환전 |
| `WithdrawCompleted` | 출금 완료 | 전체 출금 프로세스 완료 |

---

## 정합성 / 감사

| 이벤트명 | 한글명 | 발생 원인 |
|---------|--------|----------|
| `DriftDetected` | 드리프트 감지 | 거래소 상태와 내부 상태 간 불일치 감지 |
| `ReconciliationPerformed` | 정합성 검증 | 주기적 정합성 검증 수행 |
| `QuarantineStarted` | 격리 시작 | 불일치로 인해 거래 격리 모드 진입 |
| `QuarantineCompleted` | 격리 완료 | 격리 모드 해제 및 정상 운영 복귀 |

---

## 전략

| 이벤트명 | 한글명 | 발생 원인 |
|---------|--------|----------|
| `StrategyLoaded` | 전략 로드 | 전략 모듈이 메모리에 로드됨 |
| `StrategyStarted` | 전략 시작 | 전략 실행 시작 |
| `StrategyStopped` | 전략 중지 | 전략 실행 중지 |
| `StrategyError` | 전략 오류 | 전략 실행 중 오류 발생 |

---

## BNB 수수료 관리

| 이벤트명 | 한글명 | 발생 원인 |
|---------|--------|----------|
| `BnbBalanceLow` | BNB 잔고 부족 | BNB 잔고가 설정된 임계값 이하로 감소 |
| `BnbReplenishStarted` | BNB 충전 시작 | BNB 자동 충전 프로세스 시작 |
| `BnbReplenishCompleted` | BNB 충전 완료 | BNB 충전 성공 |
| `BnbReplenishFailed` | BNB 충전 실패 | BNB 충전 실패 |

---

## 참고

- 모든 이벤트는 `core/domain/events.py`의 `EventTypes` 클래스에 정의됨
- UI에서의 한글 표시는 `web/static/js/events.js`의 `EVENT_TYPE_KO` 매핑 사용
- 이벤트 발생 시 UTC 타임스탬프로 저장되며, UI 표시 시 KST로 변환됨
